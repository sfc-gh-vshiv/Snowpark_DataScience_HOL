schemaVersion: 3
meta:
  sourceVersionId: 84b2984e-714a-4b2e-ae99-c5dc9809f50e # DO NOT CHANGE - Hex uses this to match up project versions when reimporting the file
  description: This is a Snowflake Tasty Bytes extension vignette which showcases new Snowpark ML API and Model Registry features.
  projectId: c99c9535-a212-448e-9bc6-263f80f16380 # DO NOT CHANGE - Unique ID of the project from which this file was generated
  title: End-to-End Data Science using Snowpark - Intermediate Path
  timezone: null
  appTheme: SYS_PREF
  codeLanguage: PYTHON
  status:
    name: In Progress
  categories: []
  castDecimalsDefault: true
  logicQueryCacheTimeout: null
  publishedQueryCacheTimeout: null
  hexType: PROJECT
projectAssets:
  dataConnections: []
  envVars: []
  secrets: []
sharedAssets:
  secrets: []
  vcsPackages: []
  dataConnections: []
  externalFileIntegrations: []
cells:
  - cellType: TEXT
    cellId: 1a18544a-cfdf-44b4-80db-e487558dcf9e # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h1
          children:
            - text: "Overview: Flow of Snowpark ML API / MLOps Hands-on-Lab"
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/End-to-end_demo.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: a3ec1808-f611-4d7b-8621-221ae04a563b # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Background Information
        - type: p
          children:
            - text: Tasty Bytes is one of the largest food truck networks in the world with localized menu options spread across 30 major cities in 15 countries. 
            - bold: true
              text: Tasty Bytes is aiming to achieve 25% YoY sales growth over 5 years.
        - type: p
          children:
            - text: As Tasty Bytes Data Scientists, we have been asked to support this goal by helping our food truck drivers more intelligently pick where to park for shifts. 
        - type: p
          children:
            - bold: true
              text: |-
                We want to direct our trucks to locations that are expected to have the highest sales on a given shift.
                This will maximize our daily revenue across our fleet of trucks.
        - type: p
          children:
            - text: To provide this insight, we will use historical shift sales at each location to build a model. This data has been made available to us in Snowflake.Our model will provide the predicted sales at each location for the upcoming shift.
  - cellType: TEXT
    cellId: 9a761fde-e66a-48e8-b0dc-d9b1648f0fd1 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/problem_overview.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 5a5d1097-2544-402c-b28d-1ff8037c3c3f # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/snowpark_101.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 484a0c13-65b0-4172-a418-8aa4e3761e26 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Import Packages
        - type: p
          children:
            - text: |
                Just like the Python packages we are importing, we will import the Snowpark modules that we need.
            - bold: true
              text: Value
            - text: ": Snowflake modules provide efficient ways to work with data and functions in Snowflake."
  - cellType: CODE
    cellId: 372db6c3-5e25-4383-b947-4e8f79e27e20 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Libraries
    config:
      source: |-
        # Import Packages
        import pandas as pd
        import plotly.express as px
        import plotly.io as pio
        import json
        import sys
        import cachetools
        import getpass

        # Import Snowflake modules
        from snowflake.snowpark import Session
        import snowflake.snowpark.functions as F
        import snowflake.snowpark.types as T
        from snowflake.snowpark import Window
  - cellType: TEXT
    cellId: a1b20b2a-4402-4167-b647-064565e16906 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h4
          children:
            - text: Need to update snowflake-ml-python package to version 1.2.2 to reflect PuPr Model Registry syntax
  - cellType: CODE
    cellId: f1c04e2e-6574-4aa1-82e5-61d11163a510 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      source: "!pip install snowflake-ml-python==1.2.2"
  - cellType: TEXT
    cellId: a1c02cdc-edfc-4571-93f4-dba8c2c181ee # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Connect to Snowflake
        - type: p
          children:
            - text: Our assigned HOL Snowflake role, 
            - code: true
              text: <ROLEXXX>
            - text: ", can access the data in your assigned "
            - code: true
              text: <SCHEMAXXX>
            - text:  of the HOL database. We will use your assigned 
            - code: true
              text: <WHXXX>
            - text:  warehouse that has been created as a dedicated compute for data science workloads.We will use these parameters and our Snowflake account credentials to connect to Snowflake and create a Snowpark session. 
        - type: p
          children:
            - bold: true
              text: "Value:"
            - text:  Secure and governed.
  - cellType: TEXT
    cellId: 5c92d432-dce2-40d0-9526-1a6c5cf23b8c # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Create your Snowflake data connection called "HOL
            - code: true
              text: xxx
            - text: '"'
        - type: p
          children:
            - text: If you were assigned user
            - code: true
              text: xxx
            - text: ","
        - type: ul
          children:
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Name as HOL
                    - code: true
                      text: xxx
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Account as XXX-XXX,
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Warehouse as WH
                    - code: true
                      text: xxx
                    - text: ","
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Database as HOL,
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Schemas as SCHEMA
                    - code: true
                      text: xxx
                    - text: ","
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Username as USER
                    - code: true
                      text: xxx
                    - text: ","
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Password 
                    - text: (this is case sensitive)
                      italic: true
            - type: li
              children:
                - type: lic
                  children:
                    - text: set User Role as HOL
                    - code: true
                      text: xxx
        - type: p
          children:
            - text: 'For instance, if you were assigned number 1, your data connection is:{ "username": "user1", "password": "test", "account": "XXXX-XXXX", "database": "HOL", "role": "HOL1", "warehouse": "WH1", "schema": "SCHEMA1" }'
  - cellType: TEXT
    cellId: 91b67cd9-c897-44ce-90b9-38df1cc3fddd # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: p
          children:
            - text: "For instance, if you were assigned number 6, your data connection is:"
        - type: p
          children:
            - text: "If you were assigned user6, "
        - type: ul
          children:
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Name as HOL6
            - type: li
              children:
                - type: lic
                  children:
                    - text: "set Account as XXX-XXX "
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Warehouse as WH6
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Database as HOL6
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Schemas as ANALYTICS
            - type: li
              children:
                - type: lic
                  children:
                    - text: use Username & Password for Type
            - type: li
              children:
                - type: lic
                  children:
                    - text: set Username as USER6
            - type: li
              children:
                - type: lic
                  children:
                    - text: "set Password as XXX "
                    - text: (this is case sensitive)
                      italic: true
            - type: li
              children:
                - type: lic
                  children:
                    - text: set User Role as ROLE6
            - type: li
              children:
                - type: lic
                  children:
                    - text: check Snowpark integration
            - type: li
              children:
                - type: lic
                  children:
                    - text: check Allow use in writeback cells
            - type: li
              children:
                - type: lic
                  children:
                    - text: select Create connection
  - cellType: TEXT
    cellId: 0b2efba0-e899-4c89-b7b4-ab0ef9bbf752 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: ""
            - src: /api/v1/file/ca898ab9-8149-40ba-8f76-76c523a18eea
              type: image
              width: 600
              children:
                - text: ""
            - text: ""
  - cellType: INPUT
    cellId: b5441100-06bf-4557-a034-c17796260342 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Schema
    config:
      inputType: TEXT_INPUT
      name: schema
      outputType: STRING
      options: null
      defaultValue: SCHEMA0
  - cellType: INPUT
    cellId: 72e7e086-ac94-4a60-a900-cc9d9660c9a7 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Snowflake compute warehouse
    config:
      inputType: TEXT_INPUT
      name: warehouse
      outputType: STRING
      options: null
      defaultValue: WH0
  - cellType: INPUT
    cellId: c1d45c4a-c534-48a1-a0c3-fe3941534c2d # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Hex data connection name
    config:
      inputType: TEXT_INPUT
      name: connection_name
      outputType: STRING
      options: null
      defaultValue: HOL0
  - cellType: CODE
    cellId: a1935b2a-db8e-4a52-8fe6-42547ce49f31 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: HexConnection
    config:
      source: |-
        # Import Hex's hextoolkit package
        import hextoolkit as htk

        # Create Snowpark session
        session = htk.get_data_connection(connection_name).get_snowpark_session()
  - cellType: TEXT
    cellId: 70197491-a44e-46d2-9425-906fefaa7073 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h1
          children:
            - text: Part 1 - Use Snowpark to access and prepare data for modeling
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/Part1.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 644f1ae7-9722-41bc-bf02-27664b62e8d8 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Snowpark DataFrame
        - type: p
          children:
            - text: Let's create a Snowpark DataFrame containing our shift sales data from the 
            - bold: true
              text: shift_sales_v
            - text:  view in our Snowflake account using the Snowpark session.table function. A DataFrame is a data structure that contains rows and columns, similar to a SQL table.
        - type: p
          children:
            - bold: true
              text: "Value:"
            - text:  Familiar representation of data for Python users.
  - cellType: TEXT
    cellId: 354f648c-4ee1-4b9e-a71e-c4c7de40afdc # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
            - text: "\n"
        - type: h3
          children:
            - bold: true
              text: Create a Snowflake DataFrame called "snowpark_df" and then use the show command to see top 10 values
        - type: paragraph
          children:
            - text: |
                Table name is your [database name].analytics.shift_sales_v
        - type: paragraph
          children:
            - text: "TIP: Use the following link to find required code https://docs.snowflake.com/developer-guide/snowpark/reference/python/latest/index"
  - cellType: CODE
    cellId: 038c87bf-c411-4ab3-a80d-f69f1af99087 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Snowpark df
    config:
      source: "# insert code to create Snowpark DataFrame here"
  - cellType: TEXT
    cellId: 7f4e1b45-7d21-46fc-9ec4-fc30d4aa4903 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Preview the Data
        - type: p
          children:
            - text: |
                With our Snowpark DataFrame defined, let’s use the .show() function to take a look at the first 10 rows.
            - bold: true
              text: "Value:"
            - text:  Instant access to data.
  - cellType: CODE
    cellId: 201e2447-888e-41fe-9213-c63322748714 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Show_SnowflakeDF
    config:
      source: |-
        # Preview the data
        # Use the .show() function to look at the first 10 rows.
        # VALUE: instant access to data
        snowpark_df.show()
  - cellType: TEXT
    cellId: d0ed2eb5-9d6f-44a9-aec0-09151da727f5 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Select, Filter, Sort
        - type: p
          children:
            - text: "Notice the Null values for \"shift_sales\". Let's look at a single location.To do this, we will make another Snowpark DataFrame, location_df, from the above DataFrame and we will:"
        - type: ol
          children:
            - type: li
              children:
                - type: lic
                  children:
                    - text: Select columns
            - type: li
              children:
                - type: lic
                  children:
                    - text: Filter to a single location ID
            - type: li
              children:
                - type: lic
                  children:
                    - text: Sort by date
        - type: p
          children:
            - bold: true
              text: Value
            - text: ": Efficient transformation pipelines using Python syntax and chained logic."
  - cellType: TEXT
    cellId: 6f8730c9-d5de-433c-8b08-f2d173fd2529 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
            - text: "\n"
        - type: h3
          children:
            - bold: true
              text: "Create a Snowflake dataframe called location_df that only includes: date, shift, shift_sales, location_id, and city"
        - type: paragraph
          children:
            - text: |-
                Then filter the dataframe for location_id = 1135Then order the dataframe by date and shiftVisualize the first 10 records
                TIP: Use the following link to find required code https://docs.snowflake.com/developer-guide/snowpark/reference/python/latest/index
  - cellType: CODE
    cellId: aa016620-b072-43f0-bda5-4a9c1757a1f2 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: SelectFilterSort
    config:
      source: |-
        # Select
        location_df = ????

        # Filter
        location_df = ????

        # Sort
        location_df = ????

        # Display
        location_df.show(n=??)
  - cellType: TEXT
    cellId: ca02a63c-508e-4c83-acaa-f6f098dce7ed # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: p
          children:
            - text: We can see that shift sales are populated 8 days prior to the latest date in the data. The 
            - bold: true
              text: missing values
            - text:  represent future dates that do not have shift sales yet.
        - type: h2
          children:
            - text: "Snowpark works in two main ways:"
        - type: ol
          children:
            - type: li
              children:
                - type: lic
                  children:
                    - text: Snowpark code translated and executed as SQL on Snowflake
            - type: li
              children:
                - type: lic
                  children:
                    - text: Python functions deployed in a secure sandbox in Snowflake
        - type: p
          children:
            - text: ""
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/snowparkoverview.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
        - type: p
          children:
            - text: "Here's the value of using Snowpark:"
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/SnowparkValue.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
        - type: p
          children:
            - text: ""
  - cellType: TEXT
    cellId: 6ec46174-23ba-4249-9db9-922daeee96e9 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Explain the Query
        - type: p
          children:
            - text: Let's look at what was executed in Snowflake to create our location_df DataFrame.
        - type: p
          children:
            - text: The translated SQL query can be seen in the Snowsight interface under 
            - text: Activity
              italic: true
            - text:  in the 
            - text: Query History
              italic: true
            - text:  or directly in our notebook by using the explain() function. 
            - bold: true
              text: "Value:"
            - text:  Transparent execution and compute usage.
        - type: p
          children:
            - text: ""
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/query_history.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: CODE
    cellId: fada87ee-ebfd-4d8f-be5d-b7594035a4de # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: ExplainCode
    config:
      source: location_df.explain()
  - cellType: TEXT
    cellId: 0f383db9-a7b5-4572-80ba-889ad5628e29 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/data_exploration.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 6df52a84-b05f-4bc6-bfa8-f1dfb8c6b0ed # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Compare DataFrame Size
        - type: p
          children:
            - text: |
                Let's bring a sample of our Snowflake dataset to our Python environment in a pandas DataFrame using the to_pandas() function. We will compare how much memory is used for the pandas DataFrame compared to the Snowpark DataFrame. As we will see, no memory is used for the Snowpark DataFrame in our Python environment. All data in the Snowpark DataFrame remains on Snowflake.
            - bold: true
              text: "Value:"
            - text:  No copies or movement of data when working with Snowpark DataFrames.
  - cellType: CODE
    cellId: 58a22efa-5e23-42ab-a1d4-56e8b0660405 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: DFvsSnowflakeDF
    config:
      source: |-
        # Bring 10,000 rows from Snowflake to pandas
        pandas_df = snowpark_df.limit(10000).to_pandas()

        # Get Snowpark DataFrame size
        snowpark_size = sys.getsizeof(snowpark_df) / (1024*1024)
        print(f"Snowpark DataFrame Size (snowpark_df): {snowpark_size:.2f} MB")

        # Get pandas DataFrame size
        pandas_size = sys.getsizeof(pandas_df) / (1024*1024)
        print(f"Pandas DataFrame Size (pandas_df): {pandas_size:.2f} MB")
  - cellType: TEXT
    cellId: cafc2422-1297-4ea6-99ae-861ae4c30d67 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Data Exploration
        - type: p
          children:
            - text: |
                Here, we will use Snowpark to explore our data. A common pattern for exploration is to use Snowpark to manipulate our data and then bring an aggregate table to our Python environment for visualization.
            - bold: true
              text: "Value:"
            - text: |-
                 - Native Snowflake performance and scale for aggregating large datasets. - Easy transfer of aggregate data to the client-side environment for visualization.
                As we explore our data, we will highlight what is being done in Snowflake and what we are transferring to our client-side environment (Python notebook environment) for visualization.
  - cellType: TEXT
    cellId: 876ab1e9-fc6a-4b82-9838-a18a207564db # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: How many rows are in our data?
        - type: p
          children:
            - text: |
                This will give us an idea of how we might need to approach working with this data. Do we have enough data to build a meaningful model? What compute might be required? Will we need to sample the data?
            - bold: true
              text: "What's happening where?:"
            - text:  Rows counted in Snowflake. No data transfer.
  - cellType: CODE
    cellId: 8a501e01-ce68-40f6-996f-5aa242589537 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Count
    config:
      source: |-
        #Use the .count() function
        snowpark_df.count()
  - cellType: TEXT
    cellId: 797a8613-1def-4818-a998-b20b23e5cb80 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Let's calculate some descriptive statistics.
        - type: p
          children:
            - text: |
                We use the Snowpark describe() function to calculate summary statistics and then bring the aggregate results into a pandas DataFrame to visualize in a formatted table.
            - bold: true
              text: "What's happening where?:"
            - text:  Summary statistics calculated in Snowflake. Transfer aggregate summary statistics for client-side visualization.
  - cellType: CODE
    cellId: 68d6ad29-7a66-4bb5-befe-44a0b98bf3c1 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: SnowflakeDF_to_Pandas
    config:
      source: |-
        #Use the Snowpark DataFrame .describe function. You need to need to visualize from a pandas DataFrame
        snowpark_df.describe().to_pandas()
  - cellType: CODE
    cellId: afb37b34-0457-4918-831d-e4cdf4675524 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: DefineNumericColumns
    config:
      source: |-
        # What are the numeric columns?
        # Define Snowflake numeric types
        numeric_types = [T.DecimalType, T.DoubleType, T.FloatType, T.IntegerType, T.LongType]

        # Get numeric columns
        numeric_columns = [col.name for col in snowpark_df.schema.fields if type(col.datatype) in numeric_types]
        numeric_columns
  - cellType: CODE
    cellId: a32ff5d0-f4ae-46f8-999f-ec1d72d24c83 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: DefineCategoricalColumns
    config:
      source: |-
        # What are the categorical columns?
        # Define Snowflake categorical types
        categorical_types = [T.StringType]

        # Get categorical columns
        categorical_columns = [col.name for col in snowpark_df.schema.fields if type(col.datatype) in categorical_types]
        categorical_columns
  - cellType: CODE
    cellId: 3540da21-09cf-474f-9bb1-b150524b6d59 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      source: |-
        # What are the average shift sales (USD) by city?
        # Group by city and average shift sales
        analysis_df = snowpark_df.group_by("city").agg(F.mean("shift_sales").alias("avg_shift_sales"))

        # Sort by average shift sales
        analysis_df = analysis_df.sort("avg_shift_sales", ascending=True)

        # Pull to pandas and plot
        analysis_df.to_pandas().plot.barh(x="CITY", y="AVG_SHIFT_SALES")
  - cellType: TEXT
    cellId: 3cec3f83-bd11-4a4d-9d7e-f67f9ce43cc2 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/feature_engineering.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 5c60425e-2722-4278-b9a9-78b8b96bc81b # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Feature Engineering
        - type: p
          children:
            - text: |
                Now let's keep revelant columns and transform columns to create features needed for our prediction model.To make some of our features more useful, we will normalize them using standard preprocessing techniques, such as One-Hot Encoding and MinMaxScaling. With SnowparkML, you can use a standard sklearn-style API to execute fully distributed feature engineering preprocessing tasks on Snowflake compute, with zero data movement. Let's fit a scaler and encoder to our data, then use it to transform the data, producing new feature columns.
        - type: p
          children:
            - bold: true
              text: "Value:"
            - text: |
                 The Snowpark syntax makes pipelines easy to implement and understand. The syntax also allows for easy migration of Spark pipelines to Snowflake.
        - type: p
          children:
            - bold: true
              text: All transformations for feature engineering in this notebook will be executed on Snowflake compute.
        - type: p
          children:
            - text: |
                Notice what we haven't had to do? No tuning, maintenance, or operational overhead. We just need a role, warehouse, and access to the data.
            - bold: true
              text: Value
            - text: ": Near-zero maintenance. Focus on the work that brings value."
  - cellType: TEXT
    cellId: 6de9fe55-587f-4964-b79d-2e7003ff3ae0 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Create a Rolling Average Feature
        - type: p
          children:
            - text: We will use a Snowflake window function to get a 
            - bold: true
              text: rolling shift average by location
            - text:  over time. Window functions allow us to aggregate on a "moving" group of rows.
        - type: h4
          children:
            - bold: true
              text: Step 1. Create a Window
        - type: p
          children:
            - text: Our window will partition the data by location and shift. It will order rows by date. It will include all rows prior to the current date of the observation it is aggregating for.
  - cellType: TEXT
    cellId: bc403ada-4f3f-441f-ae3c-2d0fe32f9548 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
            - text: "\n"
        - type: h3
          children:
            - bold: true
              text: Use a rolling average in two steps. First, create a window_by_location_all_days by location_id and shift which is ordered by date. Then create an aggregate average location shift sales.
            - text: "\n"
        - type: paragraph
          children:
            - text: "TIP: Use the following link to find required code https://docs.snowflake.com/developer-guide/snowpark/reference/python/latest/index"
  - cellType: CODE
    cellId: 678802a0-b8c8-4bee-b69a-3d9ad50d943e # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: CreateRollingWindows
    config:
      source: |-
        window_by_location_all_days = (
            Window.partition_by(???, ???)
            .order_by(???)
            .rows_between(Window.UNBOUNDED_PRECEDING, Window.CURRENT_ROW - 1)
        )
  - cellType: TEXT
    cellId: 16b33b9b-bbae-46e2-9df5-b6bd1cecee8a # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h4
          children:
            - bold: true
              text: Step 2. Aggregate across the Window
  - cellType: CODE
    cellId: 51c2f5e4-336a-4de6-9666-08b2f7ffaa0f # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: AggregateRollingWindows
    config:
      source: |-
        snowpark_df = snowpark_df.with_column(
            ???, 
            F.avg(???).over(window_by_location_all_days)
        )
  - cellType: TEXT
    cellId: 853d56a0-730f-48eb-9b58-cdc029fcaa3c # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Impute Missing Values
        - type: p
          children:
            - text: The rolling average feature we just created is missing if there are no prior shift sales at that location. We will replace those missing values with 0.
  - cellType: CODE
    cellId: 8ea4613b-ba9e-491f-841e-3feadf15611e # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: ImputeMissingValues
    config:
      source: snowpark_df = snowpark_df.fillna(value=0, subset=["avg_location_shift_sales"])
  - cellType: TEXT
    cellId: d5f70954-75e9-4915-a521-f28262b7c82c # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Leverage Snowpark ML Modeling API to create features
        - type: p
          children:
            - text: Snowpark ML provides APIs to support each stage of an end-to-end machine learning development and deployment process and includes two key components: 
            - url: https://docs.snowflake.com/en/developer-guide/snowpark-ml/snowpark-ml-modeling
              type: a
              children:
                - text: Snowpark ML Modeling
            - text:  and 
            - url: https://docs.snowflake.com/en/developer-guide/snowpark-ml/snowpark-ml-mlops-model-registry
              type: a
              children:
                - text: Snowpark ML Ops
            - text: .
        - type: p
          children:
            - text: ""
            - url: https://docs.snowflake.com/en/developer-guide/snowpark-ml/snowpark-ml-modeling
              type: a
              children:
                - text: Snowpark ML Modeling
            - text:  supports data preprocessing, feature engineering, and model training in Snowflake using popular machine learning frameworks, such as scikit-learn, xgboost, and lightgbm. This API also includes a preprocessing module that can use compute resources provided by a Snowpark-optimized warehouse to provide scalable data transformations.
        - type: p
          children:
            - text: Snowpark ML Operations (MLOps), featuring the 
            - url: https://docs.snowflake.com/en/developer-guide/snowpark-ml/snowpark-ml-mlops-model-registry
              type: a
              children:
                - text: Snowpark ML Model Registry
            - text: ", complements the Snowpark ML Development API. The model registry allows secure deployment and management of models in Snowflake, and supports models trained both inside and outside of Snowflake."
        - type: p
          children:
            - text: ""
        - type: p
          children:
            - text: "Here are a Snowpark Features commonly used for Data Engineering tasks:"
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/Snowpark4DE.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
        - type: p
          children:
            - text: ""
        - type: p
          children:
            - text: "Here are Snowpark Features commonly used by Data Scientists for ML efforts:"
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/Snowpark4DS.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 017ef881-f71d-4e54-a21a-32dc6cd37cb3 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
        - type: h3
          children:
            - bold: true
              text: Scale up your assigned Snowflake compute warehouse.  Enter your warehouse name.
  - cellType: CODE
    cellId: 3f96b8c9-13fa-4ddb-a958-3e6d9f47b57e # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: ScaleUpSnowflakeCompute
    config:
      source: "# insert code to scale up Snowflake compute warehouse to size Large"
  - cellType: CODE
    cellId: 552e8278-ca52-4ee0-bd19-d9611ca11645 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: DefineDataTransformations
    config:
      source: |-
        # Import Snowpark ML: Machine Learning Toolkit for Snowflake
        import snowflake.ml.modeling.preprocessing as snowmlpp

        # Define our scaler and ordinal encoding functions

        # Snowpark ML scaler (MinMaxScaler) is used to shrink data within the given range, usually of 0 to 1. 
        # It transforms data by scaling features to a given range. It scales the values to a specific value range without changing the shape of the original distribution.
        # For the Tasty_Bytes data, use MinMaxScaler to normalize "CITY_POPULATION" into "CITY_POPULATION_NORM" with values between 0 and 1.

        def fit_scaler(session, df):
            mm_target_columns = ["CITY_POPULATION"]
            mm_target_cols_out = ["CITY_POPULATION_NORM"]
            snowml_mms = snowmlpp.MinMaxScaler(input_cols=mm_target_columns, output_cols=mm_target_cols_out)
            snowml_mms.fit(df)
            return snowml_mms

        # Snowpark ML ordinal encoding (OE) is used to improve model performance by providing more information to the model about categorical variables. 
        # It can help to avoid the problem of ordinality, which can occur when a categorical variable has a natural ordering (e.g. “small”, “medium”, “large”).
        # For the Tasty_Bytes data, use OE to change "SHIFT" which is currently AM or PM into and integer representation of "SHIFT_OHE" is 1.0 or 0.0. 

        def fit_oe(session, df):
            oe_target_cols = ["SHIFT"]
            oe_output_cols = ["SHIFT_OE"]
            snowml_oe = snowmlpp.OrdinalEncoder(input_cols=oe_target_cols, output_cols=oe_output_cols)
            snowml_oe.fit(df)
            return snowml_oe
  - cellType: CODE
    cellId: 03922ef5-2f99-44b5-a2e2-6ea5afd82e59 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: RunDataTransformations
    config:
      source: |-
        # Run Snowpark ML preprocessing functions against our feature data

        # For the Tasty_Bytes data, use MinMaxScaler to normalize "CITY_POPULATION" into "CITY_POPULATION_NORM" with values between 0 and 1.
        snowml_mms = fit_scaler(session, snowpark_df)
        normed_df = snowml_mms.transform(snowpark_df)

        # For the Tasty_Bytes data, use OneHotEncoder to change "SHIFT" which is currently AM or PM into and integer representation of "SHIFT_OHE_AM" is 1 or 0 and "SHIFT_OHE_PM" is 1 or 0. 
        snowml_oe = fit_oe(session, normed_df)
        oe_df = snowml_oe.transform(normed_df)
        oe_df.show()
  - cellType: TEXT
    cellId: eac0fe70-b3ee-4e11-9c5d-acbc9115f687 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Filter to Historical Data
        - type: p
          children:
            - text: Our data includes placeholders for future data with missing shift sales. The future data represents the next 7 days of shifts for all locations. The historical data has shift sales for all locations where a food truck parked during a shift. We will only use historical data when training our model and will filter out the dates where the shift_sales column is missing.
  - cellType: CODE
    cellId: 7a1338de-a6bd-43fd-b9e4-2972ef7544fd # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: RemoveDatesInFuture
    config:
      source: |-
        # Data Science best practice: Always perform data quality on your training set e.g. remove nulls or invalid cells as they are the biggest problem in a training set as they output high false positives

        # Specifically for Tasty_Bytes data, dates where "shift_sales" are null values reflect future dates where sales need to be predicted.
        # Filter out these future dates so these records will not be used in model training. 
        historical_df = oe_df.filter(F.col("shift_sales").is_not_null())
  - cellType: TEXT
    cellId: f7229f0f-e158-4bec-86ea-abf67fa05da3 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Persist Transformations
        - type: p
          children:
            - text: |
                If we want to save the changes we can either save it as a table, meaning the SQL generated by the DataFrame is executed and the result is stored in a table or as a view where the DataFrame SQL will be the definition of the view.
            - bold: true
              text: save_as_table
            - text:  saves the result in a table, if 
            - bold: true
              text: mode='overwrite'
            - text:  then it will also replace the data that is in it.
  - cellType: TEXT
    cellId: bbce5035-0649-4fa7-a6d7-af0e5e550cc0 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
            - text: "\n"
        - type: h3
          children:
            - bold: true
              text: Specify a table name to save your Snowpark DataFrame.
  - cellType: CODE
    cellId: 50177bf7-c4bc-4343-8eff-c060e9ef2e60 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: SaveDF_to_Snowflake
    config:
      source: "# enter your code to save historical.df as INPUT_DATA in database HOL and your assigned schema"
  - cellType: TEXT
    cellId: 51fd76cb-feb7-4a0b-99f9-d859cb643573 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h1
          children:
            - text: Part 2 - Use Snowflake Cortex ML-Based Function for Time-Series Forecasting
        - type: paragraph
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/Part2.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 6d2d1d70-0780-4077-91f9-96f8d3112c11 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Snowflake Cortex ML Functions
        - type: p
          children:
            - text: Time-Series Forecasting is part of Snowflake Cortex, Snowflake’s intelligent, fully-managed AI and ML service. This feature is part of the Snowflake Cortex ML-based function suite. Forecasting employs a machine learning algorithm to predict future data by using historical time series data.
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/CortexML.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
        - type: p
          children:
            - text: "Time series forecasting produces univariate predictions of future data based on historical input data. A common use case is to forecast sales based on seasonality and other factors.The historical data must include:"
        - type: ul
          children:
            - type: li
              children:
                - type: lic
                  children:
                    - text: A timestamp column.
            - type: li
              children:
                - type: lic
                  children:
                    - text: A target value column representing some quantity of interest at each timestamp.
        - type: p
          children:
            - text: |-
                
                The historical data can also include additional columns that might have influenced the target value (
            - url: https://en.wikipedia.org/wiki/Exogenous_and_endogenous_variables
              type: a
              children:
                - text: exogenous variables
            - text: ). These can be numbers or text. The nature (categorical or continuous) of each such column is automatically detected.
        - type: p
          children:
            - text: This historical data is used to train a machine learning model that produces a forecast of the value column at future timestamps. The model is a schema-level object and can be used for multiple forecasts after it is trained.
        - type: p
          children:
            - text: Forecasting works with either single-series or multi-series data. Multi-series data represents multiple independent threads of events. For example, if you have sales data for multiple stores, each store’s sales can be forecast separately by a single model based on the store identifier.
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/MLPF_Forecast.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: a5ec77f5-5ff7-4f82-b644-278fb7bba4ad # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: p
          children:
            - text: To produce forecasts of time series data, use the Snowflake built-in class 
            - url: https://docs.snowflake.com/en/sql-reference/classes/forecast
              type: a
              children:
                - text: FORECAST
            - text: ", and follow these steps:"
        - type: ol
          children:
            - type: li
              children:
                - type: lic
                  children:
                    - text: ""
                    - url: https://docs.snowflake.com/en/sql-reference/classes/forecast.html#label-class-forecast-create
                      type: a
                      children:
                        - text: Create a forecast model object
                    - text: ", passing in a reference to the training data.This object will fit (train) a model to the training data that you provide. The model is a schema-level object."
            - type: li
              children:
                - type: lic
                  children:
                    - text: Using this forecast model object, call 
                    - url: https://docs.snowflake.com/en/sql-reference/classes/forecast.html#label-class-forecast-create
                      type: a
                      children:
                        - text: CREATE SNOWFLAKE.ML.FORECAST
                    - text:  to produce a forecast, passing in information about the future period (that is, the number of time steps and values for any non-timestamp features).The method uses the model to produce a forecast.
  - cellType: TEXT
    cellId: e04ad669-55e7-4793-b659-9e3a17341d97 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h4
          children:
            - text: About the Forecasting Algorithm
        - type: p
          children:
            - text: The forecasting algorithm is powered by a 
            - url: https://en.wikipedia.org/wiki/Gradient_boosting
              type: a
              children:
                - text: gradient boosting machine
            - text:  (GBM). Like an 
            - url: https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average
              type: a
              children:
                - text: ARIMA
            - text:  model, it uses a differencing transformation to model data with a non-stationary trend and uses auto-regressive lags of the historical target data as model features.
        - type: p
          children:
            - text: Additionally, the algorithm uses rolling averages of historical target data to help predict trends and automatically produces cyclic calendar features (such as day of week and week of year) from timestamp data.
        - type: p
          children:
            - text: You can fit models with only historical target and timestamp data, or you may include exogenous data (features) that might have influenced the target value. Exogenous variables can be numerical or categorical and may be NULL (rows containing NULLs for exogenous variables are not dropped).
        - type: p
          children:
            - text: The algorithm does not rely on one-hot encoding when training on categorical features, so you can use categorical data with many dimensions (high cardinality).
        - type: p
          children:
            - text: "For more details about Snowflake's ML-Powered Forecasting Algorithm and how to use, please see "
            - url: https://docs.snowflake.com/en/user-guide/ml-powered-forecasting#about-the-forecasting-algorithm
              type: a
              children:
                - text: https://docs.snowflake.com/en/user-guide/ml-powered-forecasting#about-the-forecasting-algorithm
            - text: ""
  - cellType: TEXT
    cellId: 98081965-5929-4842-8417-3ad219dbc34d # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: p
          children:
            - text: "Here's a short video presenting "
            - url: https://www.youtube.com/watch?v=8WgVTf3im7w
              type: a
              children:
                - text: "Snowflake ML Powered Functions: Forecasting, Anomaly Detection, Contribution Explorer"
            - text: ""
        - type: paragraph
          children:
            - text: "Check out the code at: "
            - url: https://www.youtube.com/redirect?event=video_description&redir_token=QUFFLUhqbUZVS1dBWGhmYlVJUEt4MUsyWlY1VzVNbHVTUXxBQ3Jtc0ttaURLdms3dE4xeHZuVHVtVmlOZmxOQWRiOXA4RjNweWJuRTBSSkJkMnhxVUJseFhNdnBZQkZVbEVnWGdBbnFsODZ6TlZkeV9wSmo1NzhtbUZnOTdfYWE2czRjSnBmRTNkYWZpRm5lckxTay1lTi1Edw&q=https%3A%2F%2Fgithub.com%2FSnowflake-Labs%2Fsf-samples%2Fblob%2Fmain%2Fsamples%2FML%2520Powered%2520Functions%2FJune%25202023%2520MLPF%2520Demos.sql&v=8WgVTf3im7w
              type: a
              children:
                - text: https://github.com/Snowflake-Labs/sf-...
            - text: ""
        - type: paragraph
          children:
            - text: ""
  - cellType: TEXT
    cellId: 09d71afd-8dcc-42af-8aa0-403c45a6c1aa # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
            - text: "\n"
        - type: h3
          children:
            - bold: true
              text: Write SQL code to view the the SALES_FORECAST_INPUT data.
  - cellType: SQL
    cellId: 222e0427-4584-4887-99ec-61e13179ca6c # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: SQL_ViewSFTable
    config:
      source: SELECT * FROM ??? LIMIT 10;
      dataFrameCell: false
      dataConnectionId: null
      resultVariableName: dataframe_6
      useRichDisplay: false
      sqlCellOutputType: PANDAS
      useQueryMode: false
      castDecimals: true
      useNativeDates: true
      outputFilteredResult: true
      allowDuplicateColumns: false
      tableDisplayConfig: null
  - cellType: BLOCK
    cellId: 79b4ba7d-2432-436c-81a8-3d03367dd115 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 4add1568-2181-4b1b-8800-2a99922bbbc8
        chartCellId: 5e4429c7-8714-4953-a990-c4a0e9de20d7
        activeTab: preview
      cells:
        - cellType: SQL
          cellId: 4add1568-2181-4b1b-8800-2a99922bbbc8
          cellLabel: SQL_CreateSFView
          config:
            source: |-
              -- Create view for lobster sales
              CREATE OR REPLACE VIEW lobster_sales AS (
                  SELECT
                      timestamp,
                      menu_item_name,
                      total_sold
                  FROM
                      SALES_FORECAST_INPUT
                  WHERE
                      menu_item_name LIKE 'Lobster Mac & Cheese'
              );
            dataFrameCell: false
            dataConnectionId: null
            resultVariableName: dataframe
            useRichDisplay: false
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              calcs: null
              filters: null
              columnProperties:
                - originalName: Updated rows
                  renameTo: null
                  size: 130
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
              pinIndexColumns: false
        - cellType: CHARTV2
          cellId: 5e4429c7-8714-4953-a990-c4a0e9de20d7
          cellLabel: null
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 1b70b29c-2725-43c2-9744-2d737c8a91f8
                  xAxis:
                    type: string
                    style:
                      grid:
                        style: solid
                      ticks: {}
                      labels: {}
                  series: []
                  dataFrame: dataframe
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result
            outputResult: false
            displayTableConfig: null
  - cellType: SQL
    cellId: 0bc5e4d3-7f93-437b-b154-e7d47d59d015 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: ViewLobsterSales
    config:
      source: select * from schema0.lobster_sales;
      dataFrameCell: false
      dataConnectionId: null
      resultVariableName: dataframe_9
      useRichDisplay: true
      sqlCellOutputType: PANDAS
      useQueryMode: false
      castDecimals: true
      useNativeDates: true
      outputFilteredResult: true
      allowDuplicateColumns: false
      tableDisplayConfig:
        pageSize: 50
        height: null
        hideIcons: false
        hideIndex: false
        defaultSortColumn: null
        defaultSortIndexColumn: null
        defaultSortDirection: ASC
        conditionalFormatting: null
        calcs: null
        filters: null
        columnProperties:
          - originalName: MENU_ITEM_NAME
            renameTo: null
            size: 163
            wrapText: null
            displayFormat: null
          - originalName: TIMESTAMP
            renameTo: null
            size: 196
            wrapText: null
            displayFormat: null
          - originalName: TOTAL_SOLD
            renameTo: null
            size: 126
            wrapText: null
            displayFormat: null
        columnOrdering: null
        pinnedColumns: null
        hiddenColumns: null
        pinIndexColumns: false
  - cellType: SQL
    cellId: e7e9aa26-d243-441e-be80-b9a9a491d1ab # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: SQL_CreateCortexMLForecast
    config:
      source: |-
        CREATE OR REPLACE snowflake.ml.forecast lobstermac_forecast (
            INPUT_DATA => SYSTEM$REFERENCE('VIEW', 'lobster_sales'),
            TIMESTAMP_COLNAME => 'TIMESTAMP',
            TARGET_COLNAME => 'TOTAL_SOLD'
        );
      dataFrameCell: false
      dataConnectionId: null
      resultVariableName: dataframe_7
      useRichDisplay: false
      sqlCellOutputType: PANDAS
      useQueryMode: false
      castDecimals: true
      useNativeDates: true
      outputFilteredResult: true
      allowDuplicateColumns: false
      tableDisplayConfig: null
  - cellType: SQL
    cellId: e40886d2-c414-401d-8cb5-383958c4f3f1 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: SQL_ShowCortexMLForecast
    config:
      source: |-
        -- Show models to confirm training has completed: 
        SHOW snowflake.ml.forecast;
      dataFrameCell: false
      dataConnectionId: null
      resultVariableName: dataframe_8
      useRichDisplay: false
      sqlCellOutputType: PANDAS
      useQueryMode: false
      castDecimals: true
      useNativeDates: true
      outputFilteredResult: true
      allowDuplicateColumns: false
      tableDisplayConfig: null
  - cellType: TEXT
    cellId: 35ea7e99-732b-47d1-8225-92cd48487b8a # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h1
          children:
            - text: Part 3 - Use Snowpark to train a model
        - type: h1
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/Part3.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 13c942f3-a48e-4401-9a3d-f5c27c60a81e # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/model_training.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: ec4fb5db-95ae-461e-8e34-2780276b5810 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Drop Columns
        - type: p
          children:
            - text: Let's return to the original prepared table, with all cities listed, and drop columns that will not be used in the model.
  - cellType: CODE
    cellId: 231b206b-504b-4dba-9c9d-9ce4a5b4543b # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: DropUnnecessaryColumns
    config:
      source: |-
        prepared_df = historical_df.drop("location_id", "city_population", "shift", "city", "date")
        prepared_df.show()
  - cellType: TEXT
    cellId: 800078b3-dda5-4e95-8be6-4a4908a21970 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Build a simple XGBoost Regression Model on Snowflake
        - type: p
          children:
            - text: "We will now use our training data to train a linear regression model on Snowflake.Recall from above, the two main ways that Snowpark works:"
        - type: ol
          children:
            - type: li
              children:
                - type: lic
                  children:
                    - text: Snowpark code translated and executed as SQL on Snowflake
            - type: li
              children:
                - type: lic
                  children:
                    - text: Python functions deployed in a secure sandbox in Snowflake
        - type: p
          children:
            - text: We will be leveraging the deployment of Python functions into Snowflake for training and model deployment.
  - cellType: TEXT
    cellId: 50bfdd02-8e64-4e1e-8f9b-070878eb0193 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
            - text: "\n"
        - type: h3
          children:
            - bold: true
              text: Define relevant LABEL_COLUMNS and OUTPUT_COLUMNS for your XGBoost Regressor model
            - text: "\n"
        - type: paragraph
          children:
            - text: "TIP: Look up code in https://docs.snowflake.com/en/developer-guide/snowpark-ml/snowpark-ml-modeling#constructing-a-model"
  - cellType: CODE
    cellId: 8c627bdf-0ff7-4eac-a6ae-9843d10cc6d8 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: ListAvailableColumns
    config:
      source: |-
        # Retrieve column names needed in the next code block to populate feature_column_names
        prepared_df.columns
  - cellType: CODE
    cellId: f3596728-bac5-4de5-b086-94935b9e663e # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: DefinePredictionModel
    config:
      source: |-
        # Let's define relevant features needed for the prediction model.
        LABEL_COLUMNS = [???]
        OUTPUT_COLUMNS = [???]
        FEATURE_COLUMN_NAMES = ["SHIFT_OE", "CITY_POPULATION_NORM", "MONTH", "DAY_OF_WEEK","LATITUDE","LONGITUDE","AVG_LOCATION_SHIFT_SALES"]

        input_df = prepared_df.select(*LABEL_COLUMNS, *FEATURE_COLUMN_NAMES)
        input_df.show()
  - cellType: TEXT
    cellId: 632ea644-1c39-4a24-8107-4ea85810ebac # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: SnowparkML also includes metric calculations such as correlations, and more. We will use the SnowparkML correlation method on our input dataframe to identify any linearly correlated features to the output. We'll also use matplotlib to plot the resulting matrix. Notice that all of the correlation calculations are pushed down to Snowflake!
  - cellType: CODE
    cellId: 630e6ff3-84df-47ab-b47a-1a360aa4f5c8 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: RunCorrelationAnalysis
    config:
      source: |-
        import matplotlib.pyplot as plt
        import seaborn as sns
        from snowflake.ml.modeling.metrics.correlation import correlation
        corr_df = correlation(df=input_df)
  - cellType: CODE
    cellId: 5ab3b045-7fb9-4376-918d-c50cd00b7db0 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: VisualizeCorrectionAnalysis
    config:
      source: |-
        # Return only the correlation summary results to generate this heatmap
        sns.heatmap(corr_df, cmap="YlGnBu", annot=True)
  - cellType: TEXT
    cellId: 92d1bb6a-77ce-403a-b9cf-f0c6d19f720b # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: What's great about this, is that we are using a lot of Snowpark components under the hood- the dataframe API, SQL, Python stored procedures and more. But with the new SnowparkML API, data scientists can take advantage of all that Snowpark affords them, while using common, familiar APIs that match how they do their work today.
        - type: paragraph
          children:
            - text: Now that we have our feature data, let's actually fit an XGBoost model to our features to attempt to predict future sales. We'll fit several different models with different hyperparameters, and then show how we can use the Snowpark Model Registry to select our best-fit model.
  - cellType: CODE
    cellId: 91269ff2-5dd2-4dc4-8ef9-c0b7bf453161 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: SplitData_ModelTraining
    config:
      source: |-
        # Split the data into train and test sets
        train_df, test_df = input_df.random_split(weights=[0.9, 0.1], seed=98)
  - cellType: TEXT
    cellId: 6c8d8f60-d1fe-484a-abbd-1f11bb3ba8da # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: What's happening when you leverage Snowpark ML Modeling API?
        - type: p
          children:
            - text: Let's run our training job using the SnowparkML Modeling API- this will push down our model training to run on Snowflake, and you'll notice that the type of the model object returend is a SnowparkML XGBClassifier- this has some benefits, but also is fully compatible with the standard sklearn/xgboost model objects.
        - type: ul
          children:
            - type: li
              children:
                - type: lic
                  children:
                    - text: The model.fit() function actually creates a temporary stored procedure in the background. This also means that the model training is a single-node operation. Be sure to use a Snowpark Optimized Warehouse if you need more memory. We are just using an XS Standard Virtual Warehouse here, which we created at the beginning of this quickstart.
            - type: li
              children:
                - type: lic
                  children:
                    - text: The model.predict() function actually creates a temporary vectorized UDF in the background, which means the input DataFrame is batched as Pandas DataFrames and inference is parallelized across the batches of data. You can check the query history once you execute the following cell to check.
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/Snowpark_ML_API.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: a633ea4a-fa38-48c9-8797-98c389440390 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
        - type: h3
          children:
            - bold: true
              text: Import and define all the relevant details to train an XGBoost Regressor model
            - text: "\n"
        - type: p
          children:
            - text: "TIP: Look up code in https://docs.snowflake.com/en/developer-guide/snowpark-ml/snowpark-ml-modeling#constructing-a-model"
  - cellType: CODE
    cellId: 7a123050-9bc8-4d39-8380-2c8b03c21d4a # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: CreateXGBoostRegressorModel
    config:
      source: |-
        from snowflake.ml.modeling.??? import ???
        # Define the XGBRegressor
        regressor = ???(
            label_cols = ???,
            input_cols = ???,
            output_cols = ???
        )

        # Train
        regressor.fit(train_df)

        # Predict
        result = regressor.predict(test_df)
  - cellType: CODE
    cellId: 79669aba-6c2c-40e6-9858-99180d463e7b # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: RunModelOnRemainingData
    config:
      source: |-
        # Just to illustrate, we can also pass in a Pandas DataFrame to Snowpark ML's model.predict()
        regressor.predict(test_df.to_pandas())
        # try 
        regressor.predict(test_df)
  - cellType: TEXT
    cellId: fcd6643a-b134-488d-afd5-d5242c8120fe # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: Let's analyze the results using Snowpark ML's MAPE.
  - cellType: TEXT
    cellId: 49a8b7dd-6da9-4162-8e33-60892e00d75a # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
        - type: h3
          children:
            - bold: true
              text: Complete and run the mse (mean square error) for your XGBoost Regressor model results
            - text: "\n"
        - type: paragraph
          children:
            - text: "TIP: Look up code in https://docs.snowflake.com/en/developer-guide/snowpark-ml/snowpark-ml-modeling#constructing-a-model"
  - cellType: CODE
    cellId: ef744ca3-ea56-4a11-a1c2-12d972764d95 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: CalculateModelError
    config:
      source: |-
        # Use Snowpark ML metrics to calculate
        from snowflake.ml.modeling.metrics import mean_absolute_percentage_error, mean_squared_error

        # Predict
        results = regressor.predict(test_df)

        # Calculate MAPE
        mape = mean_absolute_percentage_error(df=results, y_true_col_names=LABEL_COLUMNS, y_pred_col_names=OUTPUT_COLUMNS)

        # Calculate MSE
        mse = ???

        results.select([*LABEL_COLUMNS, *OUTPUT_COLUMNS]).show()
        print(f'''Mean absolute percentage error: {mape}''')
        print(f'''Mean squared error: {mse}''')
  - cellType: CODE
    cellId: 90727401-8879-41bf-b99e-2d0c68f7954a # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: VisualizeModelError
    config:
      source: |-
        # Plot actual vs predicted 
        g = sns.relplot(data=results["SHIFT_SALES", "PRED_SHIFT_SALES"].to_pandas().astype("float64"), x="SHIFT_SALES", y="PRED_SHIFT_SALES", kind="scatter")
        g.ax.axline((0,0), slope=1, color="r")

        plt.show()
  - cellType: TEXT
    cellId: c7cc088c-fd13-4687-8976-2674fe601cac # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Snowpark ML's GridSearchCV()
        - type: paragraph
          children:
            - text: |-
                
                Now, let's use Snowpark ML's GridSearchCV() function to find optimal model parameters.
  - cellType: CODE
    cellId: edf44f12-2772-4aa5-99fd-d6d4b4f61a68 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: GridSearchOptimizedModel
    config:
      source: |-
        from snowflake.ml.modeling.model_selection import GridSearchCV

        grid_search = GridSearchCV(
        estimator=XGBRegressor(),
        param_grid={
        "n_estimators":[25, 50],
        "learning_rate":[0.4, 0.5],
        },
        n_jobs = -1,
        scoring="neg_mean_absolute_percentage_error",
        input_cols=FEATURE_COLUMN_NAMES,
        label_cols=LABEL_COLUMNS,
        output_cols=OUTPUT_COLUMNS
        )


        # Train
        grid_search.fit(train_df)
  - cellType: CODE
    cellId: 360201b3-d92f-4b16-bbb8-a233926a0794 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: AnalyzeGridSearchModel
    config:
      source: |-
        # Let's analyze the grid_search results
        gs_results = grid_search.to_sklearn().cv_results_
        n_estimators_val = []
        learning_rate_val = []
        for param_dict in gs_results["params"]:
            n_estimators_val.append(param_dict["n_estimators"])
            learning_rate_val.append(param_dict["learning_rate"])
        mape_val = gs_results["mean_test_score"]*-1

        gs_results_df = pd.DataFrame(data={
            "n_estimators":n_estimators_val,
            "learning_rate":learning_rate_val,
            "mape":mape_val})

        sns.relplot(data=gs_results_df, x="learning_rate", y="mape", hue="n_estimators", kind="line")

        plt.show()
  - cellType: CODE
    cellId: a03396aa-069d-4107-86b2-8fb7e62928c8 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: SelectOptimalModel
    config:
      source: |-
        # Let's save our optimal model and its metadata:
        optimal_model = grid_search.to_sklearn().best_estimator_
        optimal_n_estimators = grid_search.to_sklearn().best_estimator_.n_estimators
        optimal_learning_rate = grid_search.to_sklearn().best_estimator_.learning_rate


        optimal_mape = gs_results_df.loc[(gs_results_df['n_estimators']==optimal_n_estimators) &
                                (gs_results_df['learning_rate']==optimal_learning_rate),'mape'].values[0]
  - cellType: TEXT
    cellId: 11279d5a-4c8a-42a9-bb60-b6b77b44e722 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - bold: true
              text: Scale down your assigned Snowflake compute warehouse.
  - cellType: TEXT
    cellId: 7f0a8df5-d540-4cd0-a6c6-5c14ff4fa0d7 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - text: YOUR TURN
        - type: h3
          children:
            - bold: true
              text: Scale down your assigned Snowflake compute warehouse to XSmall.
  - cellType: CODE
    cellId: b68d5c32-66b4-4d51-b119-b0ae93e32891 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: ScaleDownSnowflakeCompute
    config:
      source: |-
        # Decrease size of Snowflake compute warehouse to XSMALL
        # insert your code to scale down your assigned Snowflake compute warehouse to XSmall
  - cellType: TEXT
    cellId: 50fff863-7a07-478b-954b-c10459d2b815 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h1
          children:
            - text: Part 4 - Use Snowpark for MLOps
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/Part4.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 652cfad2-0f8d-4bf0-a0d9-0d912fb09eb7 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/model_deployment.png
              type: image
              width: 600
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 68f59bd8-8f7e-474c-87ba-a3abbc1d8e9d # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Now let's use Snowflake's ML Model Registry
        - type: p
          children:
            - text: Model Registry was created to support model management operations including model registration, versioning, metadata and audit trails. Integrated deployment infrastructure for batch inference is a critical ease-of-use feature. Users can deploy ML models for batch inference from the registry directly into a Snowflake Warehouse as a vectorized UDF, or as a service to a customer-specified Compute Pool in Snowpark Container Services.
        - type: p
          children:
            - text: Snowflake's Model Registry supports SciKitLearn, XGBoost, Pytorch, Tensorflow and MLFlow (via the pyfunc interface) models.
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/Snowpark_ML_Model_Registry.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
        - type: p
          children:
            - text: Model Registry allows easy deployment of pre-trained open-source models from providers such as HuggingFace. See this blog for more details: 
            - url: https://medium.com/snowflake/whats-in-a-name-model-naming-versioning-in-snowpark-model-registry-b5f7105fd6f6
              type: a
              children:
                - text: https://medium.com/snowflake/whats-in-a-name-model-naming-versioning-in-snowpark-model-registry-b5f7105fd6f6
            - text:  or the Model Registry documentation: 
            - url: https://docs.snowflake.com/LIMITEDACCESS/snowflake-ml-model-registry
              type: a
              children:
                - text: https://docs.snowflake.com/LIMITEDACCESS/snowflake-ml-model-registry
            - text: ""
  - cellType: TEXT
    cellId: 5b42ea7b-0fc7-4c4b-b073-3b5474fa6f71 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Create the Model Registry and register your model
  - cellType: CODE
    cellId: 6a43056e-03a4-49e6-915e-6c184b5c6367 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: CreateModelRegistry
    config:
      source: |-
        from snowflake.ml.registry import Registry

        native_registry = Registry(session, database_name="HOL", schema_name=schema)
  - cellType: TEXT
    cellId: ca1355b2-0328-4f7b-bc41-2d24a1a037df # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
            - text: "\n"
        - type: h3
          children:
            - bold: true
              text: 'Define your model to be registered into the Snowflake Model Registry. Suggest using "SHIFT_SALES_PREDICTION" and version "VO". '
  - cellType: CODE
    cellId: 469e3c8a-1534-4d03-83a4-da450aca4464 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: DeleteModels_ModelRegristy
    config:
      source: |-
        # If needed, this is the code to delete models already registered
        # native_registry.delete_model("SHIFT_SALES_PREDICTION")
  - cellType: CODE
    cellId: cc717e61-3b9c-4ab6-9497-d5cd2693d0f7 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: LogOriginalXGBoostRegressorModel_ModelRegistry
    config:
      source: |-
        # Get sample input data to pass into the registry logging function
        X = train_df.select(FEATURE_COLUMN_NAMES).limit(100)

        # Define model name
        model_name = ???

        # Let's first log the very first model we trained
        model_ver = native_registry.log_model(
            model_name=model_name,
            version_name=???,
            model=regressor,
            sample_input_data=X, # to provide the feature schema
        )
  - cellType: TEXT
    cellId: e44bfc6b-5101-456e-9619-95d7f1b7b679 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
            - text: "\n"
        - type: h3
          children:
            - bold: true
              text: Register the optimal model from the GridSearchCV output. Suggest using version "V2".
  - cellType: CODE
    cellId: e1ce5d35-b905-4c37-ab7d-5ef1440da233 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: LogGridSearchXGBoostRegressorModel_ModelRegistry
    config:
      source: |-
        # Now, let's log the optimal model from GridSearchCV
        model_ver2 = native_registry.log_model(
            model_name=model_name,
            version_name=???,
            model=???,
            sample_input_data=X, # to provide the feature schema
        )

        # Add evaluation metric
        model_ver2.set_metric(metric_name=???, value=optimal_mape)

        # Add a description
        model_ver2.comment = "???"
  - cellType: CODE
    cellId: 489f7bb6-db69-4295-a29d-031991924113 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: ShowModels_ModelRegistry
    config:
      source: |-
        # Let's confirm model(s) that were added
        native_registry.get_model(model_name).show_versions()
  - cellType: CODE
    cellId: 4d0eae38-d249-4895-b9a4-eda4e61f2feb # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: ShowDefaultModel
    config:
      source: |-
        # We can see what the default model is when we have multiple versions with the same model name:
        native_registry.get_model(model_name).default.version_name
  - cellType: CODE
    cellId: 25d1379c-7225-47e6-86f6-68eac6e448e7 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: DefineDefaultModel
    config:
      source: |-
        # Now we can use the default version model to perform inference.
        model_ver = native_registry.get_model(model_name).version('V0')
        result_sdf = model_ver.run(test_df, function_name="predict")
        result_sdf.show()
  - cellType: TEXT
    cellId: bde3dcad-c0b8-4d1b-bbcb-d32bf7c8b102 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/model_utilization.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 2237ef06-6a5b-45ad-92c3-e1101e80fc8e # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: Now that our model is built and deployed, let's see it in action! We will find the best place to park in Vancouver for tomorrow morning's shift.
  - cellType: TEXT
    cellId: a2eb1d9d-07c3-47ce-841b-37777d884d49 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - bold: true
              text: YOUR TURN
            - text: "\n"
        - type: h3
          children:
            - bold: true
              text: Create a Snowflake DataFrame with only SHIFT_SALES and SHIFT_OE with future values (.isNull) for the city "Vancouver".
  - cellType: CODE
    cellId: c84f2a67-9173-47e9-b932-f2e7966de80c # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: GetVancouverShiftSales
    config:
      source: |-
        date_tomorrow_df = oe_df.filter(
            (F.col(???).isNull())
            & (F.col("shift_oe") == 1)
            & (F.col("city") == "???")
        )
        date_tomorrow_df.show()
  - cellType: CODE
    cellId: 3928d0e1-0bfe-43e1-b776-25047a0eff78 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: PredictVancouverShiftSales
    config:
      source: |-
        result_sdf = regressor.predict(date_tomorrow_df)
        result_sdf.show()
  - cellType: TEXT
    cellId: 31842c96-3529-47fc-b03f-33cc8a21c7aa # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h2
          children:
            - text: Visualize on a Map
        - type: p
          children:
            - text: "The red and yellow areas indicate higher predicted sales locations and the green zones indicate lower predicted sales. We will use this insight to ensure that our drivers are parking at the high-value locations. Value: Updated predictions readily available to drive towards our corporate goals."
  - cellType: MAP
    cellId: f3f34b1b-4eb2-41c2-a501-56e77e627e6c # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      height: 520
      map:
        theme: hex
        layers:
          - id: 62c8d4b9-386c-4191-9933-e2c05efae456
            data:
              coordinates:
                system: latlng_separate
                dataFrameLatColumn: LATITUDE
                dataFrameLngColumn: LONGITUDE
              dataFrameName: result_sdf
            fill:
              type: dynamic
              colors:
                - - 41
                  - 160
                  - 124
                - - 255
                  - 255
                  - 255
              dataFrameColumn: PRED_SHIFT_SALES
            type: scatter
            radius:
              type: static
              value: 20
            opacity: 0.6
            visible: true
            tooltipDataFrameColumns: []
  - cellType: TEXT
    cellId: 1079b66b-f01b-48f2-ae7f-d7bb273fd24d # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h1
          children:
            - text: Part 5 - Create a SiS application to use predicted outputs
        - type: p
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/Part5.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
        - type: p
          children:
            - text: "Create a SiS application for local managers to identify where to place daily food trucks. "
  - cellType: TEXT
    cellId: 79986fa6-8fd3-4781-aa37-772be3028840 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: h3
          children:
            - text: "Create new SiS app. "
        - type: h3
          children:
            - text: Replace existing code with SiS_application.py code listed below.
        - type: h3
          children:
            - text: "Update database in lines 41, 66, and 124. "
        - type: h3
          children:
            - text: "Include required pydeck and snowflake-ml-python package. "
        - type: h3
          children:
            - text: Run the SiS application.
  - cellType: TEXT
    cellId: cb716fbc-45be-47e4-b0d1-f23b524df5b7 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: paragraph
          children:
            - text: ""
            - src: https://raw.githubusercontent.com/snowflakecorp/Snowpark_DataScience_HOL/main/ForCustomer/assets/SiSapp.png
              type: image
              width: 800
              children:
                - text: ""
            - text: ""
  - cellType: TEXT
    cellId: 43ae8068-23ea-44d3-ad28-bcf20447513d # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      richText:
        - type: p
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "# Import Python packages"
        - type: paragraph
          children:
            - code: true
              text: import streamlit as st
        - type: paragraph
          children:
            - code: true
              text: import pydeck as pdk
        - type: paragraph
          children:
            - code: true
              text: import numpy as np
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "# Import Snowflake modules"
        - type: paragraph
          children:
            - code: true
              text: from snowflake.snowpark import Session
        - type: paragraph
          children:
            - code: true
              text: import snowflake.snowpark.functions as F
        - type: paragraph
          children:
            - code: true
              text: from snowflake.snowpark import Window
        - type: paragraph
          children:
            - code: true
              text: from snowflake.snowpark.context import get_active_session
        - type: paragraph
          children:
            - code: true
              text: from snowflake.ml.registry import Registry
        - type: paragraph
          children:
            - code: true
              text: import snowflake.ml.modeling.preprocessing as snowmlpp
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "# Set Streamlit page config"
        - type: paragraph
          children:
            - code: true
              text: st.set_page_config(
        - type: paragraph
          children:
            - code: true
              text: '    page_title="Streamlit App: Snowpark 101", '
        - type: paragraph
          children:
            - code: true
              text: '    page_icon=":truck:",'
        - type: paragraph
          children:
            - code: true
              text: '    layout="wide",'
        - type: paragraph
          children:
            - code: true
              text: )
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "# Add header and a subheader"
        - type: paragraph
          children:
            - code: true
              text: st.header("Predicted Shift Sales by Location")
        - type: paragraph
          children:
            - code: true
              text: st.subheader("Data-driven recommendations for food truck drivers.")
        - type: paragraph
          children:
            - code: true
              text: " "
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "# Connect to Snowflake"
        - type: paragraph
          children:
            - code: true
              text: "# session = init_connection()"
        - type: paragraph
          children:
            - code: true
              text: session = get_active_session()
        - type: paragraph
          children:
            - code: true
              text: " "
        - type: paragraph
          children:
            - code: true
              text: "# Create input widgets for cities and shift"
        - type: paragraph
          children:
            - code: true
              text: "with st.container():"
        - type: paragraph
          children:
            - code: true
              text: "    col1, col2 = st.columns(2)"
        - type: paragraph
          children:
            - code: true
              text: "    with col1:"
        - type: paragraph
          children:
            - code: true
              text: "        # Drop down to select city"
        - type: paragraph
          children:
            - code: true
              text: "        city = st.selectbox("
        - type: paragraph
          children:
            - code: true
              text: '            "City:",'
        - type: paragraph
          children:
            - code: true
              text: '            session.table("HOL.SCHEMA0.SHIFT_SALES_V")'
        - type: paragraph
          children:
            - code: true
              text: '            .select("city")'
        - type: paragraph
          children:
            - code: true
              text: "            .distinct()"
        - type: paragraph
          children:
            - code: true
              text: '            .sort("city"),'
        - type: paragraph
          children:
            - code: true
              text: "        )"
        - type: paragraph
          children:
            - code: true
              text: " "
        - type: paragraph
          children:
            - code: true
              text: "    with col2:"
        - type: paragraph
          children:
            - code: true
              text: "        # Select AM/PM Shift"
        - type: paragraph
          children:
            - code: true
              text: '        shift = st.radio("Shift:", ("AM", "PM"), horizontal=True)'
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "    n_trucks = st.selectbox('How many food trucks would you like to schedule today?', np.arange(1,10))"
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "    if n_trucks > 1:"
        - type: paragraph
          children:
            - code: true
              text: "        range = st.slider('What is the minimum distance in kilometers between food trucks?', 0, 20, 1)"
        - type: paragraph
          children:
            - code: true
              text: "        st.write('You are requesting a minimum distance of ', range, 'km')"
        - type: paragraph
          children:
            - code: true
              text: "        st.write('Click **:blue[Update]** to get the ', n_trucks, ' highest predicted Shift_Sales food truck locations.')"
        - type: paragraph
          children:
            - code: true
              text: "    else:"
        - type: paragraph
          children:
            - code: true
              text: "        st.write('Click **:blue[Update]** to get one food truck location predicted to have the Shift_Sales')"
        - type: paragraph
          children:
            - code: true
              text: "        "
        - type: paragraph
          children:
            - code: true
              text: "# Get predictions for city and shift time"
        - type: paragraph
          children:
            - code: true
              text: "def get_predictions(city, shift):"
        - type: paragraph
          children:
            - code: true
              text: "    # Get data and filter by city and shift"
        - type: paragraph
          children:
            - code: true
              text: "    snowpark_df = session.table("
        - type: paragraph
          children:
            - code: true
              text: '        "HOL.SCHEMA0.SHIFT_SALES_V"'
        - type: paragraph
          children:
            - code: true
              text: '    ).filter((F.col("shift") == shift) & (F.col("city") == city))'
        - type: paragraph
          children:
            - code: true
              text: " "
        - type: paragraph
          children:
            - code: true
              text: "    # Get rolling average"
        - type: paragraph
          children:
            - code: true
              text: "    window_by_location_all_days = ("
        - type: paragraph
          children:
            - code: true
              text: '        Window.partition_by("location_id")'
        - type: paragraph
          children:
            - code: true
              text: '        .order_by("date")'
        - type: paragraph
          children:
            - code: true
              text: "        .rows_between(Window.UNBOUNDED_PRECEDING, Window.CURRENT_ROW - 1)"
        - type: paragraph
          children:
            - code: true
              text: "    )"
        - type: paragraph
          children:
            - code: true
              text: " "
        - type: paragraph
          children:
            - code: true
              text: "    snowpark_df = snowpark_df.with_column("
        - type: paragraph
          children:
            - code: true
              text: '        "avg_location_shift_sales",'
        - type: paragraph
          children:
            - code: true
              text: '        F.avg("shift_sales").over(window_by_location_all_days),'
        - type: paragraph
          children:
            - code: true
              text: "    ).cache_result()"
        - type: paragraph
          children:
            - code: true
              text: " "
        - type: paragraph
          children:
            - code: true
              text: "    # Get tomorrow's date"
        - type: paragraph
          children:
            - code: true
              text: "    date_tomorrow = ("
        - type: paragraph
          children:
            - code: true
              text: '        snowpark_df.filter(F.col("shift_sales").is_null())'
        - type: paragraph
          children:
            - code: true
              text: '        .select(F.min("date"))'
        - type: paragraph
          children:
            - code: true
              text: "        .collect()[0][0]"
        - type: paragraph
          children:
            - code: true
              text: "    )"
        - type: paragraph
          children:
            - code: true
              text: " "
        - type: paragraph
          children:
            - code: true
              text: "    # Filter to tomorrow's date"
        - type: paragraph
          children:
            - code: true
              text: '    snowpark_df = snowpark_df.filter(F.col("date") == date_tomorrow)'
        - type: paragraph
          children:
            - code: true
              text: " "
        - type: paragraph
          children:
            - code: true
              text: "    # Impute"
        - type: paragraph
          children:
            - code: true
              text: '    snowpark_df = snowpark_df.fillna(value=0, subset=["avg_location_shift_sales"])'
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "    for colname in snowpark_df.columns:"
        - type: paragraph
          children:
            - code: true
              text: "        new_colname = str.upper(colname)"
        - type: paragraph
          children:
            - code: true
              text: "        snowpark_df = snowpark_df.with_column_renamed(colname, new_colname)"
        - type: paragraph
          children:
            - code: true
              text: " "
        - type: paragraph
          children:
            - code: true
              text: "    # Encode"
        - type: paragraph
          children:
            - code: true
              text: '    snowpark_df = snowpark_df.with_column("shift_oe", F.iff(F.col("shift") == "AM", 0, 1))\'
        - type: paragraph
          children:
            - code: true
              text: '                             .with_column("shift_oe", F.iff(F.col("shift") == "PM", 1, 0))'
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "    # Scale"
        - type: paragraph
          children:
            - code: true
              text: '    mm_target_columns = ["CITY_POPULATION"]'
        - type: paragraph
          children:
            - code: true
              text: '    mm_target_cols_out = ["CITY_POPULATION_NORM"]'
        - type: paragraph
          children:
            - code: true
              text: "    snowml_mms = snowmlpp.MinMaxScaler(input_cols=mm_target_columns, "
        - type: paragraph
          children:
            - code: true
              text: "                                       output_cols=mm_target_cols_out)"
        - type: paragraph
          children:
            - code: true
              text: "    snowml_mms.fit(snowpark_df)"
        - type: paragraph
          children:
            - code: true
              text: "    snowpark_df = snowml_mms.transform(snowpark_df)"
        - type: paragraph
          children:
            - code: true
              text: "    "
        - type: paragraph
          children:
            - code: true
              text: "    # Get all features"
        - type: paragraph
          children:
            - code: true
              text: '    feature_cols = ["SHIFT_OE", '
        - type: paragraph
          children:
            - code: true
              text: '                    "CITY_POPULATION_NORM", '
        - type: paragraph
          children:
            - code: true
              text: '                    "MONTH", '
        - type: paragraph
          children:
            - code: true
              text: '                    "DAY_OF_WEEK",'
        - type: paragraph
          children:
            - code: true
              text: '                    "LATITUDE",'
        - type: paragraph
          children:
            - code: true
              text: '                    "LONGITUDE",'
        - type: paragraph
          children:
            - code: true
              text: '                    "AVG_LOCATION_SHIFT_SALES",'
        - type: paragraph
          children:
            - code: true
              text: '                    "LOCATION_ID"]'
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "    snowpark_df = snowpark_df.select(feature_cols)"
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: '    native_registry = Registry(session=session, database_name="HOL", schema_name="SCHEMA0")'
        - type: paragraph
          children:
            - code: true
              text: "    model_ver = native_registry.get_model(\"SHIFT_SALES_PREDICTION\").version('v0')"
        - type: paragraph
          children:
            - code: true
              text: '    result_sdf = model_ver.run(snowpark_df, function_name="predict")'
        - type: paragraph
          children:
            - code: true
              text: "    return result_sdf"
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: '# Update predictions and plot when the "Update" button is clicked'
        - type: paragraph
          children:
            - code: true
              text: 'if st.button(":blue[Update]"):'
        - type: paragraph
          children:
            - code: true
              text: "    # Get predictions"
        - type: paragraph
          children:
            - code: true
              text: '    with st.spinner("Getting predictions..."):'
        - type: paragraph
          children:
            - code: true
              text: "        predictions_sdf = get_predictions(city, shift)"
        - type: paragraph
          children:
            - code: true
              text: "        predictions = predictions_sdf.to_pandas()"
        - type: paragraph
          children:
            - code: true
              text: " "
        - type: paragraph
          children:
            - code: true
              text: "    # Plot on a map"
        - type: paragraph
          children:
            - code: true
              text: '    st.subheader("Predicted Shift Sales for position")'
        - type: paragraph
          children:
            - code: true
              text: '    predictions["PRED_SHIFT_SALES"].clip(0, inplace=True)'
        - type: paragraph
          children:
            - code: true
              text: "    st.pydeck_chart("
        - type: paragraph
          children:
            - code: true
              text: "        pdk.Deck("
        - type: paragraph
          children:
            - code: true
              text: "            map_style=None,"
        - type: paragraph
          children:
            - code: true
              text: "            initial_view_state=pdk.ViewState("
        - type: paragraph
          children:
            - code: true
              text: '                latitude=predictions["LATITUDE"][0],'
        - type: paragraph
          children:
            - code: true
              text: '                longitude=predictions["LONGITUDE"][0],'
        - type: paragraph
          children:
            - code: true
              text: "                zoom=11,"
        - type: paragraph
          children:
            - code: true
              text: "                pitch=50,"
        - type: paragraph
          children:
            - code: true
              text: "            ),"
        - type: paragraph
          children:
            - code: true
              text: "            layers=["
        - type: paragraph
          children:
            - code: true
              text: "                pdk.Layer("
        - type: paragraph
          children:
            - code: true
              text: '                    "HexagonLayer",'
        - type: paragraph
          children:
            - code: true
              text: "                    data=predictions,"
        - type: paragraph
          children:
            - code: true
              text: '                    get_position="[LONGITUDE, LATITUDE]",'
        - type: paragraph
          children:
            - code: true
              text: "                    radius=200,"
        - type: paragraph
          children:
            - code: true
              text: "                    elevation_scale=4,"
        - type: paragraph
          children:
            - code: true
              text: "                    elevation_range=[0, 1000],"
        - type: paragraph
          children:
            - code: true
              text: "                    pickable=True,"
        - type: paragraph
          children:
            - code: true
              text: "                    extruded=True,"
        - type: paragraph
          children:
            - code: true
              text: "                ),"
        - type: paragraph
          children:
            - code: true
              text: "                pdk.Layer("
        - type: paragraph
          children:
            - code: true
              text: '                    "ScatterplotLayer",'
        - type: paragraph
          children:
            - code: true
              text: "                    data=predictions,"
        - type: paragraph
          children:
            - code: true
              text: '                    get_position="[LONGITUDE, LATITUDE]",'
        - type: paragraph
          children:
            - code: true
              text: '                    get_color="[200, 30, 0, 160]",'
        - type: paragraph
          children:
            - code: true
              text: "                    get_radius=200,"
        - type: paragraph
          children:
            - code: true
              text: "                ),"
        - type: paragraph
          children:
            - code: true
              text: "            ],"
        - type: paragraph
          children:
            - code: true
              text: "        )"
        - type: paragraph
          children:
            - code: true
              text: "    )"
        - type: paragraph
          children:
            - code: true
              text: "    "
        - type: paragraph
          children:
            - code: true
              text: '    max_x = predictions.loc[predictions["PRED_SHIFT_SALES"].idxmax()]'
        - type: paragraph
          children:
            - code: true
              text: '    st.write("Maximum Predicted Sales are expected at the following location:", max_x)'
        - type: paragraph
          children:
            - code: true
              text: "    #st.dataframe(predictions_sdf)"
        - type: paragraph
          children:
            - code: true
              text: "    "
        - type: paragraph
          children:
            - code: true
              text: '    location_id = max_x["LOCATION_ID"]'
        - type: paragraph
          children:
            - code: true
              text: '    lat = max_x["LATITUDE"]'
        - type: paragraph
          children:
            - code: true
              text: '    long = max_x["LONGITUDE"]'
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: '    st.subheader("The following chart is generated using the st_point and st_distance Snowflake Geospatial features")'
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: "    if n_trucks == 1:"
        - type: paragraph
          children:
            - code: true
              text: '        st.write("Have your only food truck positioned at Location ID ", location_id, " to maximize SHIFT_SALES")'
        - type: paragraph
          children:
            - code: true
              text: "    elif n_trucks > 1:"
        - type: paragraph
          children:
            - code: true
              text: "        best_locations = [location_id]"
        - type: paragraph
          children:
            - code: true
              text: "        available_locations_sdf = predictions_sdf"
        - type: paragraph
          children:
            - code: true
              text: "    "
        - type: paragraph
          children:
            - code: true
              text: "        st_distance = F.function('st_distance')"
        - type: paragraph
          children:
            - code: true
              text: "        st_point = F.function('st_point')"
        - type: paragraph
          children:
            - code: true
              text: "    "
        - type: paragraph
          children:
            - code: true
              text: "        for truck_n in np.arange(0,n_trucks - 1):"
        - type: paragraph
          children:
            - code: true
              text: '            available_locations_sdf = available_locations_sdf.with_column("DISTANCE_TO_TRUCK", '
        - type: paragraph
          children:
            - code: true
              text: "                                        st_distance("
        - type: paragraph
          children:
            - code: true
              text: "                                            st_point(F.lit(float(long)), F.lit(float(lat))),"
        - type: paragraph
          children:
            - code: true
              text: '                                            st_point(F.col("LONGITUDE"), F.col("LATITUDE"))'
        - type: paragraph
          children:
            - code: true
              text: "                                        )/1609"
        - type: paragraph
          children:
            - code: true
              text: '                                       ).filter(F.col("DISTANCE_TO_TRUCK") >= range/1.609).order_by("PRED_SHIFT_SALES", ascending=False)'
        - type: paragraph
          children:
            - code: true
              text: "            max_x = available_locations_sdf.limit(1).to_pandas()"
        - type: paragraph
          children:
            - code: true
              text: "            try:"
        - type: paragraph
          children:
            - code: true
              text: '                location_id = max_x["LOCATION_ID"].iloc[0]'
        - type: paragraph
          children:
            - code: true
              text: '                lat = max_x["LATITUDE"].iloc[0]'
        - type: paragraph
          children:
            - code: true
              text: '                long = max_x["LONGITUDE"].iloc[0]'
        - type: paragraph
          children:
            - code: true
              text: "            except:"
        - type: paragraph
          children:
            - code: true
              text: "                break"
        - type: paragraph
          children:
            - code: true
              text: "            best_locations.append(location_id)"
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: ""
        - type: paragraph
          children:
            - code: true
              text: '        selected_locations = predictions[predictions["LOCATION_ID"].isin(best_locations)]'
        - type: paragraph
          children:
            - code: true
              text: "        st.map(selected_locations)"
        - type: paragraph
          children:
            - code: true
              text: "        st.dataframe(selected_locations)"
appLayout:
  visibleMetadataFields:
    - NAME
    - DESCRIPTION
    - AUTHOR
    - LAST_EDITED
    - LAST_RUN
    - CATEGORIES
    - STATUS
    - TABLE_OF_CONTENTS
  fullWidth: false
  tabs:
    - name: Part 0 - Overview
      rows:
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 1a18544a-cfdf-44b4-80db-e487558dcf9e
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: a3ec1808-f611-4d7b-8621-221ae04a563b
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 5a5d1097-2544-402c-b28d-1ff8037c3c3f
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 484a0c13-65b0-4172-a418-8aa4e3761e26
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 372db6c3-5e25-4383-b947-4e8f79e27e20
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: f1c04e2e-6574-4aa1-82e5-61d11163a510
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: a1c02cdc-edfc-4571-93f4-dba8c2c181ee
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 5c92d432-dce2-40d0-9526-1a6c5cf23b8c
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 91b67cd9-c897-44ce-90b9-38df1cc3fddd
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 0b2efba0-e899-4c89-b7b4-ab0ef9bbf752
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 30
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: b5441100-06bf-4557-a034-c17796260342
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 30
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 72e7e086-ac94-4a60-a900-cc9d9660c9a7
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 30
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: c1d45c4a-c534-48a1-a0c3-fe3941534c2d
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: a1935b2a-db8e-4a52-8fe6-42547ce49f31
                  sharedFilterId: null
                  height: null
                  showLabel: true
    - name: Part 1 - Data Prep & Transformations
      rows:
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 70197491-a44e-46d2-9425-906fefaa7073
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 644f1ae7-9722-41bc-bf02-27664b62e8d8
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 038c87bf-c411-4ab3-a80d-f69f1af99087
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 7f4e1b45-7d21-46fc-9ec4-fc30d4aa4903
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 201e2447-888e-41fe-9213-c63322748714
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: d0ed2eb5-9d6f-44a9-aec0-09151da727f5
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: aa016620-b072-43f0-bda5-4a9c1757a1f2
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: ca02a63c-508e-4c83-acaa-f6f098dce7ed
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 6ec46174-23ba-4249-9db9-922daeee96e9
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: fada87ee-ebfd-4d8f-be5d-b7594035a4de
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 0f383db9-a7b5-4572-80ba-889ad5628e29
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 6df52a84-b05f-4bc6-bfa8-f1dfb8c6b0ed
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 58a22efa-5e23-42ab-a1d4-56e8b0660405
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: cafc2422-1297-4ea6-99ae-861ae4c30d67
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 876ab1e9-fc6a-4b82-9838-a18a207564db
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 8a501e01-ce68-40f6-996f-5aa242589537
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 68d6ad29-7a66-4bb5-befe-44a0b98bf3c1
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: afb37b34-0457-4918-831d-e4cdf4675524
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: a32ff5d0-f4ae-46f8-999f-ec1d72d24c83
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 3540da21-09cf-474f-9bb1-b150524b6d59
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 3cec3f83-bd11-4a4d-9d7e-f67f9ce43cc2
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 5c60425e-2722-4278-b9a9-78b8b96bc81b
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 6de9fe55-587f-4964-b79d-2e7003ff3ae0
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 678802a0-b8c8-4bee-b69a-3d9ad50d943e
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 51c2f5e4-336a-4de6-9666-08b2f7ffaa0f
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 853d56a0-730f-48eb-9b58-cdc029fcaa3c
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 8ea4613b-ba9e-491f-841e-3feadf15611e
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: d5f70954-75e9-4915-a521-f28262b7c82c
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 3f96b8c9-13fa-4ddb-a958-3e6d9f47b57e
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 552e8278-ca52-4ee0-bd19-d9611ca11645
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 03922ef5-2f99-44b5-a2e2-6ea5afd82e59
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: eac0fe70-b3ee-4e11-9c5d-acbc9115f687
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 7a1338de-a6bd-43fd-b9e4-2972ef7544fd
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 50177bf7-c4bc-4343-8eff-c060e9ef2e60
                  sharedFilterId: null
                  height: null
                  showLabel: true
    - name: Part 2 - Cortex ML
      rows:
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 51fd76cb-feb7-4a0b-99f9-d859cb643573
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 6d2d1d70-0780-4077-91f9-96f8d3112c11
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: e04ad669-55e7-4793-b659-9e3a17341d97
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 222e0427-4584-4887-99ec-61e13179ca6c
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 4add1568-2181-4b1b-8800-2a99922bbbc8
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 0bc5e4d3-7f93-437b-b154-e7d47d59d015
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: e7e9aa26-d243-441e-be80-b9a9a491d1ab
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: e40886d2-c414-401d-8cb5-383958c4f3f1
                  sharedFilterId: null
                  height: null
                  showLabel: true
    - name: Part 3 - Model Building
      rows:
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 35ea7e99-732b-47d1-8225-92cd48487b8a
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 13c942f3-a48e-4401-9a3d-f5c27c60a81e
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: ec4fb5db-95ae-461e-8e34-2780276b5810
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 231b206b-504b-4dba-9c9d-9ce4a5b4543b
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 800078b3-dda5-4e95-8be6-4a4908a21970
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 8c627bdf-0ff7-4eac-a6ae-9843d10cc6d8
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: f3596728-bac5-4de5-b086-94935b9e663e
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 630e6ff3-84df-47ab-b47a-1a360aa4f5c8
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 5ab3b045-7fb9-4376-918d-c50cd00b7db0
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 92d1bb6a-77ce-403a-b9cf-f0c6d19f720b
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 91269ff2-5dd2-4dc4-8ef9-c0b7bf453161
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 6c8d8f60-d1fe-484a-abbd-1f11bb3ba8da
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 7a123050-9bc8-4d39-8380-2c8b03c21d4a
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 79669aba-6c2c-40e6-9858-99180d463e7b
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: ef744ca3-ea56-4a11-a1c2-12d972764d95
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 90727401-8879-41bf-b99e-2d0c68f7954a
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: c7cc088c-fd13-4687-8976-2674fe601cac
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: edf44f12-2772-4aa5-99fd-d6d4b4f61a68
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 360201b3-d92f-4b16-bbb8-a233926a0794
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: a03396aa-069d-4107-86b2-8fb7e62928c8
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 11279d5a-4c8a-42a9-bb60-b6b77b44e722
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: b68d5c32-66b4-4d51-b119-b0ae93e32891
                  sharedFilterId: null
                  height: null
                  showLabel: true
    - name: Part 4 - Model Deployment
      rows:
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 50fff863-7a07-478b-954b-c10459d2b815
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 652cfad2-0f8d-4bf0-a0d9-0d912fb09eb7
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 68f59bd8-8f7e-474c-87ba-a3abbc1d8e9d
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 5b42ea7b-0fc7-4c4b-b073-3b5474fa6f71
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 6a43056e-03a4-49e6-915e-6c184b5c6367
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 469e3c8a-1534-4d03-83a4-da450aca4464
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: cc717e61-3b9c-4ab6-9497-d5cd2693d0f7
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: e1ce5d35-b905-4c37-ab7d-5ef1440da233
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 489f7bb6-db69-4295-a29d-031991924113
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 4d0eae38-d249-4895-b9a4-eda4e61f2feb
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: bde3dcad-c0b8-4d1b-bbcb-d32bf7c8b102
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 25d1379c-7225-47e6-86f6-68eac6e448e7
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: c84f2a67-9173-47e9-b932-f2e7966de80c
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 3928d0e1-0bfe-43e1-b776-25047a0eff78
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 31842c96-3529-47fc-b03f-33cc8a21c7aa
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: f3f34b1b-4eb2-41c2-a501-56e77e627e6c
                  sharedFilterId: null
                  height: null
                  showLabel: true
    - name: Part 5 - Model Utilization in SiS
      rows:
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 1079b66b-f01b-48f2-ae7f-d7bb273fd24d
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 79986fa6-8fd3-4781-aa37-772be3028840
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: cb716fbc-45be-47e4-b0d1-f23b524df5b7
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 43ae8068-23ea-44d3-ad28-bcf20447513d
                  sharedFilterId: null
                  height: null
                  showLabel: true
sharedFilters: []
